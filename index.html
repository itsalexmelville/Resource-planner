<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Studio Forecasting</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const { Plus, X, Users, Briefcase, Calendar, Clock } = lucideReact;

        const DesignStudioForecastingApp = () => {
          // Initialize state
          const [designers, setDesigners] = useState([
            { id: 1, name: 'Jazmine' },
            { id: 2, name: 'Josh' },
            { id: 3, name: 'Alex' },
            { id: 4, name: 'Darren' }
          ]);

          const [projects, setProjects] = useState([
            { id: 1, name: 'Project Alpha', color: '#3B82F6' },
            { id: 2, name: 'Project Beta', color: '#EF4444' }
          ]);

          const [currentWeek, setCurrentWeek] = useState(0);
          const [numWeeks, setNumWeeks] = useState(4);
          const [allocations, setAllocations] = useState({});
          const [newDesignerName, setNewDesignerName] = useState('');
          const [newProjectName, setNewProjectName] = useState('');

          const DAILY_CAPACITY = 7;
          const DAYS_PER_WEEK = 5;

          // Generate date labels for the current week
          const getWeekDates = (weekIndex) => {
            const dates = [];
            const today = new Date();
            const startOfWeek = new Date(today);
            startOfWeek.setDate(today.getDate() - today.getDay() + 1 + (weekIndex * 7)); // Monday start
            
            for (let i = 0; i < DAYS_PER_WEEK; i++) {
              const date = new Date(startOfWeek);
              date.setDate(startOfWeek.getDate() + i);
              dates.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
            }
            return dates;
          };

          // Get allocation key
          const getAllocationKey = (designerId, projectId, weekIndex, dayIndex) => {
            return `${designerId}-${projectId}-${weekIndex}-${dayIndex}`;
          };

          // Get allocation value
          const getAllocation = (designerId, projectId, weekIndex, dayIndex) => {
            const key = getAllocationKey(designerId, projectId, weekIndex, dayIndex);
            return allocations[key] || 0;
          };

          // Update allocation
          const updateAllocation = (designerId, projectId, weekIndex, dayIndex, hours) => {
            const key = getAllocationKey(designerId, projectId, weekIndex, dayIndex);
            const numHours = Math.max(0, Math.min(DAILY_CAPACITY, parseFloat(hours) || 0));
            setAllocations(prev => ({
              ...prev,
              [key]: numHours
            }));
          };

          // Calculate total hours for a designer on a specific day
          const getDailyTotal = (designerId, weekIndex, dayIndex) => {
            return projects.reduce((total, project) => {
              return total + getAllocation(designerId, project.id, weekIndex, dayIndex);
            }, 0);
          };

          // Calculate weekly totals
          const getWeeklyTotal = (designerId, weekIndex) => {
            let total = 0;
            for (let day = 0; day < DAYS_PER_WEEK; day++) {
              total += getDailyTotal(designerId, weekIndex, day);
            }
            return total;
          };

          // Calculate project totals
          const getProjectTotal = (projectId, weekIndex) => {
            let total = 0;
            for (let day = 0; day < DAYS_PER_WEEK; day++) {
              designers.forEach(designer => {
                total += getAllocation(designer.id, projectId, weekIndex, day);
              });
            }
            return total;
          };

          // Add designer
          const addDesigner = () => {
            if (newDesignerName.trim()) {
              const newId = Math.max(...designers.map(d => d.id), 0) + 1;
              setDesigners([...designers, { id: newId, name: newDesignerName.trim() }]);
              setNewDesignerName('');
            }
          };

          // Remove designer
          const removeDesigner = (id) => {
            if (designers.length > 1) {
              setDesigners(designers.filter(d => d.id !== id));
              // Clean up allocations for removed designer
              const newAllocations = { ...allocations };
              Object.keys(newAllocations).forEach(key => {
                if (key.startsWith(`${id}-`)) {
                  delete newAllocations[key];
                }
              });
              setAllocations(newAllocations);
            }
          };

          // Add project
          const addProject = () => {
            if (newProjectName.trim()) {
              const colors = ['#10B981', '#8B5CF6', '#F59E0B', '#06B6D4', '#84CC16', '#EC4899'];
              const newId = Math.max(...projects.map(p => p.id), 0) + 1;
              const color = colors[projects.length % colors.length];
              setProjects([...projects, { id: newId, name: newProjectName.trim(), color }]);
              setNewProjectName('');
            }
          };

          // Remove project
          const removeProject = (id) => {
            if (projects.length > 1) {
              setProjects(projects.filter(p => p.id !== id));
              // Clean up allocations for removed project
              const newAllocations = { ...allocations };
              Object.keys(newAllocations).forEach(key => {
                if (key.includes(`-${id}-`)) {
                  delete newAllocations[key];
                }
              });
              setAllocations(newAllocations);
            }
          };

          const weekDates = getWeekDates(currentWeek);

          return React.createElement('div', { className: "min-h-screen bg-gray-50 p-6" },
            React.createElement('div', { className: "max-w-7xl mx-auto" },
              // Header
              React.createElement('div', { className: "mb-8" },
                React.createElement('h1', { className: "text-3xl font-bold text-gray-900 mb-2" }, "Design Studio Forecasting"),
                React.createElement('p', { className: "text-gray-600" }, "Manage your team's capacity and project allocations")
              ),

              // Controls
              React.createElement('div', { className: "bg-white rounded-lg shadow-sm border p-6 mb-6" },
                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-6" },
                  // Team Management
                  React.createElement('div', {},
                    React.createElement('h3', { className: "text-lg font-semibold mb-3 flex items-center" },
                      React.createElement(Users, { className: "w-5 h-5 mr-2" }),
                      "Team Management"
                    ),
                    React.createElement('div', { className: "space-y-2" },
                      React.createElement('div', { className: "flex gap-2" },
                        React.createElement('input', {
                          type: "text",
                          placeholder: "Designer name",
                          value: newDesignerName,
                          onChange: (e) => setNewDesignerName(e.target.value),
                          className: "flex-1 px-3 py-2 border rounded-md text-sm",
                          onKeyPress: (e) => e.key === 'Enter' && addDesigner()
                        }),
                        React.createElement('button', {
                          onClick: addDesigner,
                          className: "px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm"
                        }, React.createElement(Plus, { className: "w-4 h-4" }))
                      ),
                      React.createElement('div', { className: "text-sm text-gray-600" },
                        `Team: ${designers.length} designers × ${DAILY_CAPACITY}h/day`
                      )
                    )
                  ),

                  // Project Management
                  React.createElement('div', {},
                    React.createElement('h3', { className: "text-lg font-semibold mb-3 flex items-center" },
                      React.createElement(Briefcase, { className: "w-5 h-5 mr-2" }),
                      "Project Management"
                    ),
                    React.createElement('div', { className: "space-y-2" },
                      React.createElement('div', { className: "flex gap-2" },
                        React.createElement('input', {
                          type: "text",
                          placeholder: "Project name",
                          value: newProjectName,
                          onChange: (e) => setNewProjectName(e.target.value),
                          className: "flex-1 px-3 py-2 border rounded-md text-sm",
                          onKeyPress: (e) => e.key === 'Enter' && addProject()
                        }),
                        React.createElement('button', {
                          onClick: addProject,
                          className: "px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm"
                        }, React.createElement(Plus, { className: "w-4 h-4" }))
                      ),
                      React.createElement('div', { className: "text-sm text-gray-600" },
                        `Active: ${projects.length} projects`
                      ),
                      React.createElement('div', { className: "mt-2 space-y-1 max-h-24 overflow-y-auto" },
                        projects.map(project =>
                          React.createElement('div', {
                            key: project.id,
                            className: "flex items-center justify-between text-sm py-1 px-2 bg-gray-50 rounded"
                          },
                            React.createElement('div', { className: "flex items-center" },
                              React.createElement('div', {
                                className: "w-3 h-3 rounded-full mr-2",
                                style: { backgroundColor: project.color }
                              }),
                              React.createElement('span', { className: "truncate" }, project.name)
                            ),
                            React.createElement('button', {
                              onClick: () => removeProject(project.id),
                              className: "text-red-600 hover:text-red-800 ml-2",
                              disabled: projects.length <= 1,
                              title: "Remove project"
                            }, React.createElement(X, { className: "w-3 h-3" }))
                          )
                        )
                      )
                    )
                  ),

                  // Week Navigation
                  React.createElement('div', {},
                    React.createElement('h3', { className: "text-lg font-semibold mb-3 flex items-center" },
                      React.createElement(Calendar, { className: "w-5 h-5 mr-2" }),
                      "Week Navigation"
                    ),
                    React.createElement('div', { className: "space-y-2" },
                      React.createElement('div', { className: "flex gap-2" },
                        React.createElement('button', {
                          onClick: () => setCurrentWeek(Math.max(0, currentWeek - 1)),
                          className: "px-3 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 text-sm",
                          disabled: currentWeek === 0
                        }, "← Prev"),
                        React.createElement('button', {
                          onClick: () => setCurrentWeek(Math.min(numWeeks - 1, currentWeek + 1)),
                          className: "px-3 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 text-sm",
                          disabled: currentWeek === numWeeks - 1
                        }, "Next →")
                      ),
                      React.createElement('div', { className: "text-sm text-gray-600" },
                        `Week ${currentWeek + 1} of ${numWeeks}`
                      )
                    )
                  )
                )
              ),

              // Main Forecasting Grid
              React.createElement('div', { className: "bg-white rounded-lg shadow-sm border overflow-hidden" },
                React.createElement('div', { className: "p-4 bg-gray-50 border-b" },
                  React.createElement('h2', { className: "text-xl font-semibold flex items-center" },
                    React.createElement(Clock, { className: "w-5 h-5 mr-2" }),
                    `Week ${currentWeek + 1} Allocation - ${weekDates[0]} to ${weekDates[4]}`
                  )
                ),

                React.createElement('div', { className: "overflow-x-auto" },
                  React.createElement('table', { className: "w-full" },
                    React.createElement('thead', {},
                      React.createElement('tr', { className: "bg-gray-50 border-b" },
                        React.createElement('th', { className: "text-left p-3 font-semibold" }, "Designer"),
                        ...weekDates.map((date, index) =>
                          React.createElement('th', {
                            key: index,
                            className: "text-center p-3 font-semibold min-w-32"
                          }, date)
                        ),
                        React.createElement('th', { className: "text-center p-3 font-semibold" }, "Week Total"),
                        React.createElement('th', { className: "text-center p-3 font-semibold" }, "Actions")
                      )
                    ),
                    React.createElement('tbody', {},
                      designers.map(designer =>
                        React.createElement(React.Fragment, { key: designer.id },
                          // Designer name row
                          React.createElement('tr', { className: "border-b bg-blue-50" },
                            React.createElement('td', {
                              className: "p-3 font-semibold text-blue-900",
                              colSpan: 8
                            },
                              designer.name,
                              React.createElement('button', {
                                onClick: () => removeDesigner(designer.id),
                                className: "ml-2 text-red-600 hover:text-red-800",
                                disabled: designers.length <= 1
                              }, React.createElement(X, { className: "w-4 h-4" }))
                            )
                          ),
                          
                          // Project allocation rows for this designer
                          ...projects.map(project =>
                            React.createElement('tr', {
                              key: `${designer.id}-${project.id}`,
                              className: "border-b hover:bg-gray-50"
                            },
                              React.createElement('td', { className: "p-3 pl-8 text-sm" },
                                React.createElement('div', { className: "flex items-center" },
                                  React.createElement('div', {
                                    className: "w-3 h-3 rounded-full mr-2",
                                    style: { backgroundColor: project.color }
                                  }),
                                  project.name
                                )
                              ),
                              
                              // Daily allocation inputs
                              ...Array.from({ length: DAYS_PER_WEEK }).map((_, dayIndex) => {
                                const currentAllocation = getAllocation(designer.id, project.id, currentWeek, dayIndex);
                                const dailyTotal = getDailyTotal(designer.id, currentWeek, dayIndex);
                                const isOverCapacity = dailyTotal > DAILY_CAPACITY;
                                
                                return React.createElement('td', {
                                  key: dayIndex,
                                  className: "p-2 text-center"
                                },
                                  React.createElement('input', {
                                    type: "number",
                                    min: "0",
                                    max: DAILY_CAPACITY,
                                    step: "0.5",
                                    value: currentAllocation || '',
                                    onChange: (e) => updateAllocation(designer.id, project.id, currentWeek, dayIndex, e.target.value),
                                    className: `w-16 px-2 py-1 text-center border rounded text-sm ${
                                      isOverCapacity ? 'border-red-300 bg-red-50' : 'border-gray-300'
                                    }`,
                                    placeholder: "0"
                                  })
                                );
                              }),
                              
                              // Week total for this project
                              React.createElement('td', { className: "p-3 text-center text-sm font-medium" },
                                Array.from({ length: DAYS_PER_WEEK }).reduce((total, _, dayIndex) => 
                                  total + getAllocation(designer.id, project.id, currentWeek, dayIndex), 0
                                ).toFixed(1) + 'h'
                              ),
                              
                              React.createElement('td', { className: "p-3" })
                            )
                          ),
                          
                          // Daily totals row for this designer
                          React.createElement('tr', { className: "border-b bg-gray-100" },
                            React.createElement('td', { className: "p-3 pl-8 text-sm font-semibold" }, "Daily Totals"),
                            ...Array.from({ length: DAYS_PER_WEEK }).map((_, dayIndex) => {
                              const total = getDailyTotal(designer.id, currentWeek, dayIndex);
                              const isOverCapacity = total > DAILY_CAPACITY;
                              return React.createElement('td', {
                                key: dayIndex,
                                className: `p-3 text-center font-semibold text-sm ${
                                  isOverCapacity ? 'text-red-600' : total === DAILY_CAPACITY ? 'text-green-600' : 'text-gray-900'
                                }`
                              }, `${total.toFixed(1)}h / ${DAILY_CAPACITY}h`);
                            }),
                            React.createElement('td', { className: "p-3 text-center font-semibold text-sm" },
                              `${getWeeklyTotal(designer.id, currentWeek).toFixed(1)}h / ${DAILY_CAPACITY * DAYS_PER_WEEK}h`
                            ),
                            React.createElement('td', { className: "p-3" })
                          )
                        )
                      )
                    )
                  )
                )
              ),

              // Project Summary
              React.createElement('div', { className: "mt-6 bg-white rounded-lg shadow-sm border p-6" },
                React.createElement('h3', { className: "text-lg font-semibold mb-4" }, `Project Summary - Week ${currentWeek + 1}`),
                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" },
                  projects.map(project => {
                    const projectTotal = getProjectTotal(project.id, currentWeek);
                    return React.createElement('div', {
                      key: project.id,
                      className: "p-4 border rounded-lg"
                    },
                      React.createElement('div', { className: "flex items-center mb-2" },
                        React.createElement('div', {
                          className: "w-4 h-4 rounded-full mr-2",
                          style: { backgroundColor: project.color }
                        }),
                        React.createElement('h4', { className: "font-semibold" }, project.name)
                      ),
                      React.createElement('p', { className: "text-2xl font-bold text-gray-900" }, projectTotal.toFixed(1) + 'h'),
                      React.createElement('p', { className: "text-sm text-gray-600" }, "Total allocated this week")
                    );
                  })
                )
              )
            )
          );
        };

        ReactDOM.render(React.createElement(DesignStudioForecastingApp), document.getElementById('root'));
    </script>
</body>
</html>